SELECT OUTS.ANIMAL_ID, OUTS.NAME
FROM ANIMAL_OUTS OUTS
         LEFT JOIN ANIMAL_INS INS ON INS.ANIMAL_ID = OUTS.ANIMAL_ID
WHERE INS.ANIMAL_ID IS NOT NULL
ORDER BY TIMESTAMPDIFF(DAY, INS.DATETIME, OUTS.DATETIME) DESC
LIMIT 2;

SELECT HOUR(OUTS.DATETIME), COUNT(*) AS count
FROM ANIMAL_OUTS OUTS
WHERE HOUR(OUTS.DATETIME) > 8 AND HOUR(OUTS.DATETIME) < 20
GROUP BY HOUR(OUTS.DATETIME)
ORDER BY HOUR(OUTS.DATETIME);

WITH RECURSIVE AHOURS AS(
    SELECT 0 AS hour
    UNION ALL
    SELECT hour + 1 FROM AHOURS WHERE hour < 23
)

SELECT AHOURS.hour, COUNT(HOUR(OUTS.DATETIME))
FROM AHOURS
         LEFT JOIN ANIMAL_OUTS OUTS ON AHOURS.hour = HOUR(OUTS.DATETIME)
GROUP BY HOUR(OUTS.DATETIME), AHOURS.hour;

SELECT INS.ANIMAL_ID, INS.NAME, IF(INS.SEX_UPON_INTAKE REGEXP "(Neutered|Spayed)", 'O', 'X') AS 중성화
FROM ANIMAL_INS INS
ORDER BY INS.ANIMAL_ID;

SELECT INS.ANIMAL_TYPE, IFNULL(INS.NAME, 'No name'), INS.SEX_UPON_INTAKE
FROM ANIMAL_INS INS;